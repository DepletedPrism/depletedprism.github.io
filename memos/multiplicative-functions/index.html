<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<title>
  
    一些积性函数相关的简单筛法
  
</title>

<meta name="description" content="useless algorithm 警告… 综述记录了一些利用筛法求积性函数的方法.">
<meta property="og:type" content="article">
<meta property="og:title" content="一些积性函数相关的简单筛法">
<meta property="og:url" content="https://depletedprism.github.io/memos/multiplicative-functions/index.html">
<meta property="og:site_name" content="DepletedPrism&#39;s Blog">
<meta property="og:description" content="useless algorithm 警告… 综述记录了一些利用筛法求积性函数的方法.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://depletedprism.github.io/images/multiplicative-functions/table.jpg">
<meta property="article:published_time" content="2022-08-27T16:00:00.000Z">
<meta property="article:modified_time" content="2022-09-03T14:10:33.957Z">
<meta property="article:author" content="DepletedPrism">
<meta property="article:tag" content="Number Theory">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://depletedprism.github.io/images/multiplicative-functions/table.jpg">


  <link rel="alternative" href="/atom.xml" title="DepletedPrism&#39;s Blog" type="application/atom+xml">



  <link rel="icon" href="/images/favicon.jpg">



<link rel="stylesheet" href="/perfect-scrollbar/css/perfect-scrollbar.min.css">


<link rel="stylesheet" href="/styles/main.css">







<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head>
<body
  
    class="monochrome"
  
  >
  <div class="mobile-header">
  <button class="sidebar-toggle" type="button">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <a class="title" href="/">DepletedPrism&#39;s Blog</a>
</div>

  <div class="main-container">
    <div class="sidebar">
  <div class="header">
    <h1 class="title"><a href="/">DepletedPrism&#39;s Blog</a></h1>
    
      <p class="subtitle">
        厌离秽土, 欣求净土.
      </p>
    
    <div class="info">
      <div class="content">
        
        
          <div class="author">DepletedPrism</div>
        
      </div>
      
        <div class="avatar">
          
            <a href="/about"><img src="/images/favicon.jpg"></a>
          
        </div>
      
    </div>
  </div>
  <div class="body">
    
      
        <ul class="nav">
          
            
              <li class="category-list-container">
                <a href="javascript:;">分类</a>
                <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9A%8F%E7%AC%94/">随笔</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a><span class="category-list-count">38</span></li></ul>
              </li>
            
          
            
              <li class="tag-list-container">
                <a href="javascript:;">标签</a>
                <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Calculus/" rel="tag">Calculus</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Combinatorics/" rel="tag">Combinatorics</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DP/" rel="tag">DP</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Structure/" rel="tag">Data Structure</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Game-Theory/" rel="tag">Game Theory</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Geometry/" rel="tag">Geometry</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Graph/" rel="tag">Graph</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Greedy/" rel="tag">Greedy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Number-Theory/" rel="tag">Number Theory</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Polynomial/" rel="tag">Polynomial</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Probability/" rel="tag">Probability</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/String/" rel="tag">String</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vim/" rel="tag">Vim</a><span class="tag-list-count">1</span></li></ul>
              </li>
            
          
            
              <li class="archive-list-container">
                <a href="javascript:;">归档</a>
                <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/9102/">9102</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">42</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">4</span></li></ul>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
                <a href="/index.html" title="Homepage" external="false">Homepage</a>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
                <a href="https://github.com/DepletedPrism" title="Github" target="_blank" rel="noopener">Github</a>
              </li>
            
          
            
              <li>
                <a href="https://codeforces.com/profile/DepletedPrism" title="Codeforces" target="_blank" rel="noopener">Codeforces</a>
              </li>
            
          
        </ul>
      
    
  </div>
</div>

    <div class="main-content">
      
        <div style="max-width: 1000px">
      
          <article id="post-memos/multiplicative-functions" class="article article-type-post">
  
    <h1 class="article-header">
      一些积性函数相关的简单筛法
    </h1>
  
  

  <div class="article-info">
    <span class="article-date">
  2022-08-28
</span>

    
	<span class="article-category tagcloud">
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></li></ul>
	</span>


    
	<span class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Number-Theory/" rel="tag">Number Theory</a></li></ul>
	</span>


	
  </div>
  <div class="article-entry">
    <hr>
<p>useless algorithm 警告…</p>
<h2 id="综述"><a href="#综述" class="headerlink" title="综述"></a>综述</h2><p>记录了一些利用筛法求积性函数的方法.</p>
<span id="more"></span>
<h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><h3 id="数论函数"><a href="#数论函数" class="headerlink" title="数论函数"></a>数论函数</h3><p>数论函数指定义域为正整数, 陪域为复数的函数. 下面是几个常用的数论函数.</p>
<h4 id="幂函数"><a href="#幂函数" class="headerlink" title="幂函数"></a>幂函数</h4><script type="math/tex; mode=display">\operatorname{Id}_k(n) = n^k</script><p>特别地, 当 $k = 1$ 时, 记 $\operatorname{Id} = \operatorname{Id}_1(n) = n$.</p>
<h4 id="单位函数"><a href="#单位函数" class="headerlink" title="单位函数"></a>单位函数</h4><script type="math/tex; mode=display">\epsilon(n) = [n = 1]</script><p>其中 $[P]$ 在 $P$ 为真时值为 $1$, $P$ 为假时值为 $0$. </p>
<h4 id="常数函数"><a href="#常数函数" class="headerlink" title="常数函数"></a>常数函数</h4><script type="math/tex; mode=display">1(n) = 1</script><h3 id="积性函数"><a href="#积性函数" class="headerlink" title="积性函数"></a>积性函数</h3><p>若数论函数 $f$ 满足</p>
<ol>
<li><p>$f(1) = 1$.</p>
</li>
<li><p>当 $a$ 和 $b$ 互质 (也记作 $a\perp b$), 即 $\gcd(a,\ b) = 1$ 时, 有 $f(ab) = f(a)\cdot f(b)$.</p>
</li>
</ol>
<p>则称 $f$ 为积性函数. 特别地, 在此基础上如果 $f$ 还满足对于任意正整数 $a$, $b$ 均有 $f(ab) = f(a)\cdot f(b)$, 则称 $f$ 为完全积性函数.</p>
<h3 id="狄利克雷卷积"><a href="#狄利克雷卷积" class="headerlink" title="狄利克雷卷积"></a>狄利克雷卷积</h3><p>对于数论函数 $f$ 与 $g$, 若数论函数 $h$ 满足</p>
<script type="math/tex; mode=display">h(n) = \sum_{d|n}f(d) \cdot g\left(\frac{n}{d}\right)</script><p>则称 $h$ 为 $f$ 与 $g$ 的狄利克雷卷积, 记作 $h = f\ast g$.</p>
<p>狄利克雷卷积满足结合律, 交换律以及分配律. 此外, 对于任意数论函数 $f$ 有 $f\ast\epsilon = \epsilon\ast f = f$.</p>
<h2 id="埃氏筛-埃拉托斯特尼筛"><a href="#埃氏筛-埃拉托斯特尼筛" class="headerlink" title="埃氏筛 / 埃拉托斯特尼筛"></a>埃氏筛 / 埃拉托斯特尼筛</h2><p>假定现在需要得到 $1$ 到 $n$ 中的所有质数, 一个直接的筛法是从 $2$ 到 $n$ 枚举整数 $i$, 那么除去 $i$ 外的所有 $i$ 的倍数一定是合数. 如果枚举到 $i$ 时该数还没有被标记为合数, 那么 $i$ 为合数. 根据调和级数这样做的时间复杂度为 $O(n\log n)$.</p>
<p>如果在上述过程中只枚举质数的倍数, 就可以得到埃氏筛. 由唯一分解定理可知这样做是对的. 埃氏筛的时间复杂度为</p>
<script type="math/tex; mode=display">O\left(n\sum_{k=1}^{\pi(n)}\frac{1}{p_k}\right) = O(n\log\log n)</script><p>证明可参考 <a href="https://oi-wiki.org/math/number-theory/sieve/#%E5%9F%83%E6%8B%89%E6%89%98%E6%96%AF%E7%89%B9%E5%B0%BC%E7%AD%9B%E6%B3%95">https://oi-wiki.org/math/number-theory/sieve/</a>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">eratosthenes</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">  <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">npr</span><span class="params">(n)</span>, pr</span>;</span><br><span class="line">  npr[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!npr[i]) &#123;</span><br><span class="line">      pr.<span class="built_in">push_back</span>(i);</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span> * i; j &lt; n; j += i)</span><br><span class="line">        npr[j] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>后文的 min_25 筛一定程度上是埃氏筛的拓展.</p>
<h2 id="欧拉筛"><a href="#欧拉筛" class="headerlink" title="欧拉筛"></a>欧拉筛</h2><p>仍然考虑如何得到 $1$ 到 $n$ 中的所有质数. 从 $2$ 到 $n$ 枚举整数 $i$, 并依次枚举小于等于 $i$ 的所有质数 $p$. 显然 $i\cdot p$ 一定是合数. 同时, 为了避免一个数被重复标记, 此处希望 $p$ 是 $i\cdot p$ 的最小质因子, 因此当 $i \bmod p = 0$ 时就停止枚举.</p>
<p>这就是欧拉筛. 考虑到每个合数只会被对应的最小质因子标记一次, 欧拉筛的时间复杂度为 $O(n)$.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">euler</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">  <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">npr</span><span class="params">(n)</span>, pr</span>;</span><br><span class="line">  npr[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!npr[i]) pr.<span class="built_in">push_back</span>(i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="keyword">int</span>) pr.<span class="built_in">size</span>() &amp;&amp; i * pr[j] &lt; n; ++j) &#123;</span><br><span class="line">      npr[i * pr[j]] = <span class="literal">true</span>;</span><br><span class="line">      <span class="comment">// pr[j] 是 i * pr[j] 的最小质因子</span></span><br><span class="line">      <span class="keyword">if</span> (i % pr[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一个重要的性质在于, 通过欧拉筛可以得到每个数的最小质因子. 凭借此点可以在 $O(n)$ 的时间复杂度内得到诸多积性函数前 $n$ 项的值. 譬如</p>
<h3 id="约数函数"><a href="#约数函数" class="headerlink" title="约数函数"></a>约数函数</h3><script type="math/tex; mode=display">\sigma_k(n) = \sum_{d|n}d^k</script><p>显然这一系列函数都是积性函数, 下面先来讨论 $k$ 为 $0$ 和 $1$ 的两种情况.</p>
<h4 id="约数个数函数"><a href="#约数个数函数" class="headerlink" title="约数个数函数"></a>约数个数函数</h4><p>当 $k=0$ 时, 常用 $d(n)$ 来表示 $\sigma_0(n)$. 此时 $d(n)$ 的含义是 $n$ 的约数个数.</p>
<script type="math/tex; mode=display">d(n) = \sigma_0(n) = \sum_{d|n}1</script><p>对于正整数 $n$, 由唯一分解定理设 $n$ 可表示为</p>
<script type="math/tex; mode=display">n = \prod_i p_i^{c_i}</script><p>其中 $p_i$ 为质数. 那么 $d(n)$ 可表示为</p>
<script type="math/tex; mode=display">d(n) = \prod_i (1 + c_i)</script><p>这就提供了一种计算 $d(n)$ 的方法, 设 $g(n)$ 表示 $n$ 的最小质因子对 $d(n)$ 的贡献, 也就是最小质因子的相应指数再加 $1$. 考虑欧拉筛的过程, 有</p>
<ul>
<li><p>$d(1) = 1$, $g(1) = 1$.</p>
</li>
<li><p>若 $i$ 为质数, 有 $d(i) = 2$, $g(i) = 2$.</p>
</li>
<li><p>若 $i$ 不为质数, 分两种情况讨论:  </p>
<ul>
<li><p>$i \bmod p_j \neq 0$</p>
<p>此时 $p_j$ 为 $i\cdot p_j$ 的最小质因子, 且 $i\perp p_j$, 故有</p>
<script type="math/tex; mode=display">
\begin{align*}
g(i \cdot p_j) &= 2\\
d(i \cdot p_j) &= d(p_j) \cdot d(i) = 2 \cdot d(i)
\end{align*}</script></li>
<li><p>$i \bmod p_j = 0$</p>
<p>此时 $p_j$ 仍为 $i\cdot p_j$ 的最小质因子, 但对应的指数大于 $1$. 可以利用 $g(i)$ 来更新, 具体而言, 有 $g(i\cdot p_j) = g(i) + 1$. 根据上文的式子, $d(i)$ 和 $d(i \cdot p_j)$ 之间只有 $p_j$ 参与的部分存在不同. 因此有</p>
<script type="math/tex; mode=display">d(i \cdot p_j) = d(i)\ \frac{g(i \cdot p_j)}{g(i)}</script></li>
</ul>
</li>
</ul>
<p>另外, 有这样一个流传甚广的表格. 可以看到在 $n$ 很大的时候 $d(n)$ 并不是特别大. 其中的 $\omega(n)$ 表示 $n$ 的不同质因子的个数.</p>
<div style="text-align:center;"><img src="/images/multiplicative-functions/table.jpg" width="480" /> </div>

<h4 id="约数和函数"><a href="#约数和函数" class="headerlink" title="约数和函数"></a>约数和函数</h4><p>当 $k=1$ 时, 常用 $\sigma(n)$ 来表示 $\sigma_1(n)$. 此时 $\sigma(n)$ 的含义是 $n$ 的所有约数之和.</p>
<script type="math/tex; mode=display">\sigma(n) = \sigma_1(n) = \sum_{d|n}d</script><p>同 $d(n)$ 类似, 约数和 $\sigma(n)$ 可以表示为</p>
<script type="math/tex; mode=display">\sigma(n) = \prod_i(1+p_i^1+\cdots+p_i^{c_i})</script><p>记 $n$ 的最小质因子为 $p$, 对应指数为 $c$. 同样设 $g(n)$ 表示 $p$ 对答案的贡献. 则有</p>
<script type="math/tex; mode=display">g(n) = 1 + p + p^2 + \cdots + p^c</script><p>接下来的过程和 $d(n)$ 几乎相同. 同样的思路可以在 $k \ge 1$ 的情况下沿用. 实际上, 对于任意质数 $p$ 有</p>
<script type="math/tex; mode=display">\sigma_k(p^x) = 1 + p^{k\cdot 1} + p^{k\cdot 2} + \cdots + p^{k\cdot x} = \frac{(p^k)^{x+1} - 1}{p^k - 1}</script><p>凭借上式以及唯一分解定理就可以解决 $k\ge 1$ 的情况.</p>
<h3 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h3><p>记 $\varphi(n)$ 表示小于等于 $n$ 且同 $n$ 互质的正整数的个数. 即</p>
<script type="math/tex; mode=display">\varphi(n) = \sum_{k=1}^n [\gcd(k, n) = 1]</script><p>这个形式看不出什么性质, 接下来将进一步推导出一个同 $n$ 的质因数分解相关的形式. 考虑到对于任意质数 $p$, 有</p>
<script type="math/tex; mode=display">\varphi(p^k) = p^k - p^{k-1} = p^k\left(1 - \frac{1}{p}\right)</script><p>这是很好理解的. 若一个数同 $p$ 的某个幂次 $p^k$ 不互质, 这个数一定是 $p$ 的倍数, 同时在小于等于 $p^k$ 的范围内这个倍数存在 $p^{k-1}$ 个, 故 $\varphi(p^k) = p^k-p^{k-1}$.</p>
<p>又因为 $\varphi(n)$ 为积性函数, 故对于正整数 $n$, 有</p>
<script type="math/tex; mode=display">\varphi(n) =  n \prod_i\left(1 - \frac{1}{p_i}\right)</script><p>接下来分情况讨论就好了, 讨论过程可以参考 $d(n)$.</p>
<h3 id="莫比乌斯函数"><a href="#莫比乌斯函数" class="headerlink" title="莫比乌斯函数"></a>莫比乌斯函数</h3><script type="math/tex; mode=display">
\mu(n) =
\begin{cases}
  1 & n=1\\
  (-1)^s & n = \prod_{i=1}^s p_i\\
  0 & \text{otherwise}
\end{cases}</script><p>换言之, 对于 $n &gt; 1$, 如果 $n$ 不含有平方因子, 那么 $\mu(n) = (-1)^s$, 其中 $s$ 表示 $n$ 不同质因子的个数; 如果 $n$ 含有平方因子, 那么 $\mu(n) = 0$.</p>
<p>同样地, 接下来分情况讨论就好了.</p>
<p>总而言之, 对于积性函数 $f$, 记 $n$ 的最小质因子为 $p$, 对应次数为 $c$, 且 $n \neq p^c$, 则 $p^c \perp n/p^c$, 因此 $f(n) = f(p^c)f(n/p^c)$. 借此就可以利用欧拉筛计算 $f$.</p>
<h2 id="杜教筛"><a href="#杜教筛" class="headerlink" title="杜教筛"></a>杜教筛</h2><p>杜教筛借助了狄利克雷卷积的一些性质, 可以在 $O(n^{2/3})$ 的时间复杂度内计算某些积性函数的前缀和.</p>
<h3 id="欧拉函数-1"><a href="#欧拉函数-1" class="headerlink" title="欧拉函数"></a>欧拉函数</h3><p>首先有性质 $\operatorname{Id} = \varphi\ast 1$. 这是因为</p>
<blockquote>
<p>考虑枚举 $1$ 到 $n$ 中每个整数 $k$ 和 $n$ 的最大公约数 $d$, 有</p>
<script type="math/tex; mode=display">
\begin{align*}
n &= \sum_{k=1}^n \sum_{d|n} [\gcd(k, n) = d] \\
&= \sum_{d|n} \sum_{k=1}^{n/d} \left[\gcd\left(k, \frac{n}{d}\right) = 1\right] \\
&= \sum_{d|n} \varphi\left(\frac{n}{d}\right) =\sum_{d|n}\varphi(d)
\end{align*}</script></blockquote>
<p>此外也可以利用 $(\varphi\ast 1)(p^k) = p^k$ 以及 $\operatorname{Id}_k$ 的完全积性来证明.</p>
<p>记 $\phi(n) = \sum_{k=1}^n \varphi(k)$. 则</p>
<script type="math/tex; mode=display">
\begin{align*}
\sum_{k=1}^n k &= \frac{1}{2}n(n+1) \\
&= \sum_{k = 1}^n \sum_{d|k}\varphi\left(\frac{k}{d}\right) \\
&= \sum_{d = 1}^n \sum_{k=1}^{\lfloor\frac{n}{d}\rfloor}\varphi(k)
= \sum_{d = 1}^n \phi\left(\left\lfloor\frac{n}{d}\right\rfloor\right)
\end{align*}</script><p>因此</p>
<script type="math/tex; mode=display">\phi(n) = \frac{1}{2}n(n+1) - \sum_{d=2}^n \phi\left(\left\lfloor\frac{n}{d}\right\rfloor\right)</script><p>只需用利用 $\lfloor\frac{n}{d}\rfloor$ 的 $O(\sqrt n)$ 种不同就取值就能够计算出 $\phi(n)$, 可以用记忆化搜索来实现, 空间复杂度为 $O(\sqrt{n})$. 此外, 计算一处 $\phi(n)$ 的时间复杂度为 $O(\sqrt{n})$, 即数论分块合并答案的时间复杂度. 记总体的时间复杂度为 $T(n)$, 则</p>
<script type="math/tex; mode=display">
\begin{align*}
T(n) &= \sum_{k=1}^{\lfloor\sqrt{n}\rfloor} O(\sqrt{k}) + \sum_{k=1}^{\lfloor\sqrt{n}\rfloor}O\left(\sqrt{\left\lfloor\frac{n}{k}\right\rfloor}\right) \\
&= O\left(\int_1^{\sqrt{n}}\left(\sqrt{x} + \sqrt{\frac{n}{x}}\right)\mathrm d x\right) = O(n^{3/4})
\end{align*}</script><p>如果用欧拉筛预处理 $\phi$ 前 $S$ 项, 且 $S &gt; \sqrt n$, 则有</p>
<script type="math/tex; mode=display">
\begin{align*}
T(n) &= O(S) + \sum_{k=1}^{n/S} O\left(\sqrt{\left\lfloor\frac{n}{k}\right\rfloor}\right)\\
&= O\left(S + \int_1^{n/S} \sqrt{\frac{n}{x}}\mathrm dx\right) = O\left(S + \frac{n}{S^{1/2}}\right)
\end{align*}</script><p>取 $S = n^{2/3}$, 则 $T(n) = O(n^{2/3})$, 此时的空间复杂度也是 $O(n^{2/3})$. 更为细致的复杂度分析可参考 <a href="https://riteme.site/blog/2018-9-11/time-space-complexity-dyh-algo.html">杜教筛的时空复杂度分析 - riteme.site</a>.</p>
<h3 id="莫比乌斯函数-1"><a href="#莫比乌斯函数-1" class="headerlink" title="莫比乌斯函数"></a>莫比乌斯函数</h3><p>对于莫比乌斯函数, 则有 $\epsilon = \mu\ast 1$. 下面分两种情况证明这个结论.</p>
<blockquote>
<p>当 $n = 1$ 时, 有 $\epsilon(1) = \mu(1) = 1$.</p>
<p>当 $n &gt; 1$ 时, 有 $\epsilon(n) = 0$. 设 $n$ 有 $s$ 个不同质因子, 对于 $n$ 的约数 $d$, 如果 $d$ 能对和式的值产生贡献, 即 $\mu(d) \neq 0$, 则 $d$ 一定是若干 $n$ 的质因子的乘积. 枚举选择的质因子个数 $k$, 有</p>
<script type="math/tex; mode=display">\sum_{d|n} \mu(d) = \sum_{k=0}^s (-1)^k \binom{n}{k} = (1 - 1)^s = 0</script><p>综上有 $\epsilon = \mu \ast 1$.</p>
</blockquote>
<p>另外, 考虑到 $\epsilon \ast f = f$, 若 $g=f\ast 1$, 则有 $g\ast\mu=f\ast 1\ast\mu = f$, 即</p>
<script type="math/tex; mode=display">g(n) = \sum_{d|n}f(d) \iff f(n) = \sum_{d|n}g(d)\mu\left(\frac{n}{d}\right)</script><p>其实就是所谓的莫比乌斯反演.</p>
<p>记 $M(n) = \sum_{k=1}^n \mu(k)$, 利用</p>
<script type="math/tex; mode=display">\sum_{k=1}^n [k = 1] = 1 = \sum_{k=1}^n\sum_{d|k}\mu\left(\frac{k}{d}\right)</script><p>借助于分析 $\phi(n)$ 时同样的思路可以得到</p>
<script type="math/tex; mode=display">M(n) = 1 - \sum_{d=2}^n M\left(\left\lfloor\frac{n}{d}\right\rfloor\right)</script><h3 id="约数个数函数-1"><a href="#约数个数函数-1" class="headerlink" title="约数个数函数"></a>约数个数函数</h3><p>虽然有 $\sigma_k = \operatorname{Id}_k \ast\ 1$, 但是</p>
<script type="math/tex; mode=display">\sum_{k=1}^n \sigma_k(n) = \sum_{d=1}^n \left\lfloor\frac{n}{d}\right\rfloor \cdot d^k</script><p>直接数论分块就好了, 剩余部分就是正整数的 $k$ 次方和.</p>
<h3 id="稍微一般的形式"><a href="#稍微一般的形式" class="headerlink" title="稍微一般的形式"></a>稍微一般的形式</h3><p>对于数论函数 $f$ 与 $g$, 记 $F(n) = \sum_{k=1}^n f(k)$, 则</p>
<script type="math/tex; mode=display">
\begin{align*}
\sum_{k=1}^n \left(f \ast g\right)(k) &= \sum_{k=1}^n \sum_{d|k} g(d)\cdot f\left(\frac{k}{d}\right) \\
&= \sum_{d = 1}^n g(d) \sum_{k=1}^{\lfloor\frac{n}{d}\rfloor} f(k)
= \sum_{d = 1}^n g(d) \cdot F\left(\left\lfloor\frac{n}{d}\right\rfloor\right)
\end{align*}</script><p>因此</p>
<script type="math/tex; mode=display">g(1)\cdot F(n) = \sum_{k=1}^n \left(f\ast g\right)(k) - \sum_{d=2}^n g(d)\cdot F\left(\left\lfloor\frac{n}{d}\right\rfloor\right)</script><p>在求 $\phi$ 与 $M$ 的过程中, $g$ 可以在 $O(1)$ 的时间复杂度内计算. 实际上, 如果 $f$, $g$, $f\ast g$ 三者的前缀和中存在两个可以在不劣于杜教筛的时间复杂度内计算, 就可以利用杜教筛计算第三个.</p>
<h2 id="Powerful-Number-筛"><a href="#Powerful-Number-筛" class="headerlink" title="Powerful Number 筛"></a>Powerful Number 筛</h2><p>高中的时候听都没听过的东西. 以及终于不是用人名来命名了…</p>
<p>咕咕咕…</p>
<h2 id="洲阁筛"><a href="#洲阁筛" class="headerlink" title="洲阁筛"></a>洲阁筛</h2><p>咕咕咕…</p>
<h2 id="min-25-筛"><a href="#min-25-筛" class="headerlink" title="min_25 筛"></a>min_25 筛</h2><p>咕咕咕…</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li>冯东宇, 基础数论, 洛谷 2019 年 OI 夏令营.</li>
<li>11Dimensions, 从 1 开始的数论, 洛谷 2019 年 OI 夏令营.</li>
<li>任之洲, 积性函数求和的几种方法, 国家集训队 2016 论文集.</li>
<li>OI wiki, <a href="https://oi-wiki.org/">https://oi-wiki.org/</a>.</li>
<li>riteme, 杜教筛的时空复杂度分析, <a href="https://riteme.site/blog/2018-9-11/time-space-complexity-dyh-algo.html">https://riteme.site/blog/2018-9-11/time-space-complexity-dyh-algo.html</a></li>
<li>铃悬, 铃悬的数学小讲堂——狄利克雷卷积与莫比乌斯反演, <a href="https://www.luogu.com.cn/blog/lx-2003/mobius-inversion">https://www.luogu.com.cn/blog/lx-2003/mobius-inversion</a>.</li>
</ul>
<hr>

  </div>
  <footer class="article-footer">
    
  <div class="cc">
    <a href="http://creativecommons.org/licenses/by-nc/4.0/deed.z" target="_blank" title="署名-非商业性使用">
      <img src="/images/cc/cc.png">
      
          <img src="/images/cc/by.png">
        
          <img src="/images/cc/nc.png">
        
      <span>
        本作品采用知识共享 署名-非商业性使用 4.0 国际许可协议进行许可。
      </span>
    </a>
  </div>


  </footer>
  
</article>





          <div class="main-footer">
  
    © 2019-2023 DepletedPrism&#39;s Blog
    
	- Powered by <a href="http://hexo.io" target="_blank">Hexo</a> - Theme <a href="https://github.com/denjones/hexo-theme-chan" target="_blank">Chan</a>
  
</div>

      
        </div>
      
    </div>
  </div>
  
<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>


  
<link rel="stylesheet" href="/PhotoSwipe/photoswipe.css">

  
<link rel="stylesheet" href="/PhotoSwipe/default-skin/default-skin.css">


  <!-- Root element of PhotoSwipe. Must have class pswp. -->
  <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
             It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

      <!-- Container that holds slides.
                PhotoSwipe keeps only 3 of them in the DOM to save memory.
                Don't modify these 3 pswp__item elements, data is added later on. -->
      <div class="pswp__container">
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
      </div>

      <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
      <div class="pswp__ui pswp__ui--hidden">

        <div class="pswp__top-bar">

          <!--  Controls are self-explanatory. Order can be changed. -->

          <div class="pswp__counter"></div>

          <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

          <button class="pswp__button pswp__button--share" title="Share"></button>

          <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

          <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

          <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
          <!-- element will get class pswp__preloader--active when preloader is running -->
          <div class="pswp__preloader">
            <div class="pswp__preloader__icn">
              <div class="pswp__preloader__cut">
                <div class="pswp__preloader__donut"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
          <div class="pswp__share-tooltip"></div>
        </div>

        <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>

        <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

        <div class="pswp__caption">
          <div class="pswp__caption__center"></div>
        </div>
      </div>
    </div>
  </div>

  
<script src="/PhotoSwipe/photoswipe.js"></script>

  
<script src="/PhotoSwipe/photoswipe-ui-default.js"></script>




<script src="/perfect-scrollbar/js/min/perfect-scrollbar.min.js"></script>


<script src="/scripts/main.js"></script>


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
